[test]
Description: Cache hit on infected reparable file | Expected: serves cached clean doc 

# Request a doc which was sent with a virus by the OS
# but should have been repaired and cached by the proxy

### request

[client-request]
request: {
	GET http://$(SVR_HOST):$(SVR_PORT)/file1.exe http/1.0
	Host: http://$(SVR_HOST):$(SVR_PORT)/
	User-Agent: HTTP Protocol Tester Client 1.0
	Content-Length: 0
}

### response

### verification
[output]
#print-headers: true 
#print-body: true 

[server-response]
verify-header-not-valid: true

[proxy-request]
verify-header-not-valid: true

[proxy-response]
# Content-Length should be 35 as vscan should have cleaned the file
# and leave only the clean content which is 35 bytes 
Must-have: {
	Status == 200
	Server: HTTP Protocol Tester 1.0
	Content-Type: application/binary 
	Content-Length: 35
}
verify-header-valid: true


